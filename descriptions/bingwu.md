# A股超短交易系统

## 收盘复盘 & 次日作战文档规范（Codex 输出用）

> **定位说明**：
> 本文档是给自动化系统（Codex）使用的**结构化复盘与交易计划生成规范**，
> 用于：
>
> * 每日收盘后自动复盘
> * 判断「次日是否适合交易」
> * 明确「做什么 / 不做什么 / 如何做」
>
> **数据前提**：
>
> * 行情数据：AkShare
> * 存储：本地 MySQL
> * 输出：Markdown / HTML / PDF 均可

---

## 一、整体流程总览（必须严格按顺序）

```
行情数据 → 情绪周期判定 → 题材扫描 → 龙头/结构分析 → 个股打分
→ 次日交易计划 → 仓位规划 → 风险提示
```

任何一步判定为 **「不可交易」**，后续步骤可跳过，仅输出“空仓建议”。

---

## 二、模块一：市场情绪周期判定（全局开关）

### 2.1 核心目的

判断 **次一交易日是否允许主动交易**。

### 2.2 输入数据（AkShare）

* 全市场涨停数量
* 全市场跌停数量
* 连板高度（最高板）
* 炸板率（炸板数 / (炸板数 + 封板数)）
* 昨日高位股收益情况（可选）

### 2.3 判定逻辑（示例规则）

| 指标   | 上升期   | 震荡期    | 退潮期   |
| ---- | ----- | ------ | ----- |
| 连板高度 | ≥ 昨日  | 持平     | 下降    |
| 跌停数量 | ≤ 5   | 5–10   | > 10  |
| 炸板率  | < 30% | 30–50% | > 50% |

### 2.4 输出字段

```json
{
  "market_emotion": "上升期 | 震荡期 | 退潮期",
  "emotion_score": 0-100,
  "operation_permission": true | false
}
```

> ⚠️ `operation_permission = false` 时，后续仅输出【空仓建议】。

---

## 三、模块二：题材扫描与强度评估

### 3.1 核心目的

确定 **是否存在值得参与的主线题材**。

### 3.2 输入数据

* 涨停股所属概念
* 板块涨停数量
* 板块内最高连板高度
* 板块日内涨幅
* 尾盘资金方向（可选）

### 3.3 题材强度评分模型（建议）

| 项目    | 规则        | 分值 |
| ----- | --------- | -- |
| 新题材   | 当日首次大规模出现 | +2 |
| 板块涨停数 | ≥3 只      | +2 |
| 龙头高度  | 市场最高或并列最高 | +2 |
| 尾盘回流  | 14:30 后拉升 | +2 |

**题材总分 ≥ 5 才允许进入下一步分析**。

### 3.4 输出字段

```json
{
  "hot_themes": [
    {
      "theme_name": "XXX",
      "theme_score": 0-8,
      "is_core_theme": true | false
    }
  ]
}
```

---

## 四、模块三：龙头识别与结构判断

### 4.1 核心目的

只锁定 **1–2 个可操作标的**，避免分散。

### 4.2 龙头判定标准（满足 ≥3 项）

* 板块内最早涨停
* 连板高度最高
* 日内分时最强
* 炸板后可快速回封

### 4.3 结构阶段判定

| 阶段   | 特征      | 是否允许交易 |
| ---- | ------- | ------ |
| 启动期  | 首板 / 2板 | ✅      |
| 主升初期 | 2–3 板   | ✅      |
| 高位期  | ≥4 板    | ⚠️ 降权  |
| 退潮期  | 断板      | ❌      |

### 4.4 输出字段

```json
{
  "candidates": [
    {
      "symbol": "000001",
      "role": "龙头 | 次龙",
      "structure_stage": "启动期 | 主升 | 高位",
      "structure_score": 0-5
    }
  ]
}
```

---

## 五、模块四：个股可交易性评分（核心决策）

### 5.1 评分维度

| 维度   | 条件        | 分值 |
| ---- | --------- | -- |
| 题材归属 | 核心题材      | +2 |
| 市场情绪 | 上升 / 震荡   | +2 |
| 位置   | 板块内相对低位   | +1 |
| 封板质量 | 炸板少 / 封单稳 | +2 |
| 换手结构 | 非天量       | +1 |

**总分 ≥ 6：允许写入交易计划**。

### 5.2 输出字段

```json
{
  "tradable": true | false,
  "stock_score": 0-8
}
```

---

## 六、模块五：次日交易计划生成（重点输出）

### 6.1 单票交易计划结构

```json
{
  "operation_type": "打板 | 低吸 | 半路",
  "entry_conditions": [
    "高开不超过5%",
    "开盘10分钟不破分时均价",
    "板块至少1只跟风异动"
  ],
  "stop_loss_rules": [
    "跌破分时均价",
    "10分钟无动能",
    "板块整体转弱"
  ],
  "take_profit_logic": "情绪溢价",
  "sell_plan": "高开或冲高放量卖"
}
```

### 6.2 强制要求

* **禁止模糊表述**（如“视情况而定”）
* 所有条件必须可程序化判断

---

## 七、模块六：仓位与风险控制

### 7.1 仓位建议规则

| 情绪周期 | 最大总仓位  |
| ---- | ------ |
| 上升期  | 50–60% |
| 震荡期  | 20–30% |
| 退潮期  | 0–10%  |

### 7.2 输出字段

```json
{
  "max_position": "30%",
  "risk_level": "低 | 中 | 高"
}
```

---

## 八、最终文档输出结构（建议）

```markdown
# XXXX年XX月XX日 收盘复盘

## 一、市场情绪判定

## 二、核心题材

## 三、备选个股

## 四、次日交易计划

## 五、仓位与风险提示
```

---

## 九、设计原则（写给 Codex）

1. **先过滤，后精细化**
2. **宁可少做，不可乱做**
3. 所有结论必须能追溯到数据
4. 输出的是“行动方案”，不是“市场解说”

---

> **一句系统级原则**：
> 当系统给不出明确计划时，默认输出 —— **空仓，是最优交易。**
